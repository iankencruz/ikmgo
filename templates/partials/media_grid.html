{{ define "media_grid" }}
<div
  id='{{ or .ID "media-grid" }}'
  class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-1"
>
  {{ if not .Media }}
  <p class="text-red-500">‚ö†Ô∏è No media to display.</p>
  {{ end }} {{ range .Media }}
  <div
    class="relative aspect-square hover:bg-black/50 flex border border-gray-400"
    data-id="{{ .ID }}"
    {{
    if
    $.GalleryID
    }}data-gallery="{{ $.GalleryID }}"
    {{
    end
    }}
    {{
    if
    $.ProjectID
    }}data-project="{{ $.ProjectID }}"
    {{
    end
    }}
  >
    {{ if and .MimeType (hasPrefix .MimeType "video/") }}
    <!-- üé• Self-hosted Video -->
    <video
      class="absolute inset-0 w-full h-full object-cover"
      controls
      preload="metadata"
      poster="{{ .ThumbnailURL }}"
    >
      <source src="{{ .FullURL }}" type="{{ .MimeType }}" />
      Your browser does not support the video tag.
    </video>
    {{ else if .EmbedURL }}
    <!-- üîó Embedded Video (e.g. Vimeo/YouTube) -->
    <iframe
      src="{{ .EmbedURL }}"
      class="absolute inset-0 w-full h-full"
      frameborder="0"
      allow="autoplay; fullscreen; picture-in-picture"
      allowfullscreen
    ></iframe>

    {{ else }}
    <!-- üñºÔ∏è Image -->
    <img
      src="{{ .ThumbnailURL }}"
      data-full="{{ .FullURL }}"
      alt="{{ .FileName }}"
      class="absolute inset-0 w-full h-full object-cover cursor-pointer"
      loading="lazy"
    />
    {{ end }}
  </div>
  {{ end }}

  <!-- üí° Lightbox Modal (shared between views) -->
  <div
    id="lightboxModal"
    class="fixed inset-0 flex items-center justify-center bg-black/80 hidden z-50"
  >
    <button
      id="lightboxClose"
      class="absolute top-4 right-8 text-white text-3xl font-bold px-2 cursor-pointer"
    >
      &times;
    </button>
    <button
      id="lightboxPrev"
      class="absolute left-4 text-white text-3xl font-bold px-2 cursor-pointer"
    >
      &#10094;
    </button>
    <button
      id="lightboxNext"
      class="absolute right-4 text-white text-3xl font-bold px-2 cursor-pointer"
    >
      &#10095;
    </button>
    <img
      id="lightboxImg"
      alt="Lightbox Image"
      class="max-h-[80vh] max-w-[90vw] mx-auto"
    />
  </div>
</div>
{{ end }}
